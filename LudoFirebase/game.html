<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
    <div id="app"></div>
    <div>
        <input onclick="reset()" type="button" value="Reset">
        <input onclick="save()" type="button" value="Save">
        <input onclick="restore()" type="button" value="Restore">
        <input onclick="rollDice(); show()" type="button" value='Roll Dice'>
        <p style="font-size: 25px; color: blue; display: inline;" id="diceP"></p>
    </div>
    <script src="js/model.js"></script>
    <script src="js/view.js"></script>
    <script src="js/controller.js"></script>
    </script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-app.js"></script>
    <!-- https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-firestore.js"></script>
    <script>
        // Your web app's Firebase configuration
        let firebaseConfig = {
            apiKey: "AIzaSyBo_9YA4kqwXLu5XktffPjEpOoc26q7zYE",
            authDomain: "teste-project-d52c9.firebaseapp.com",
            databaseURL: "https://teste-project-d52c9.firebaseio.com",
            projectId: "teste-project-d52c9",
            storageBucket: "teste-project-d52c9.appspot.com",
            messagingSenderId: "574239903404",
            appId: "1:574239903404:web:258f8a1eb2c0cc88639909",
            measurementId: "G-HMXQHTL53T"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        let db = firebase.firestore()
        let model = null;
        let modelPieces = null;

        db.collection('app').doc('model').onSnapshot(
            function (collectionSnapshot) {
                console.log(collectionSnapshot.data().pieces);
                model = collectionSnapshot.data();
                modelPieces = collectionSnapshot.data().pieces;
                show()
            }
        )

        function addDatabase() {
            // -> Lager ny collection om den ikke finnes <-
            return db.collection("app").doc('model').set({
                Nei: 'Nei'
            }
            ).then(function () {
                console.log("Document successfully written!");
            })
                .catch(function (error) {
                    console.error("Error writing document: ", error);
                });
        }

        function addDatabaseMerge() {
            // -> Samme som over, bare at den merger og ikke replacer hele <-
            return db.collection("testModel").doc('test').set({
                Neiduen: 'Nei'
            }, {
                merge: true
            }).then(function () {
                console.log("Document successfully written!");
            })
                .catch(function (error) {
                    console.error("Error writing document: ", error);
                });
        }

        function getModelInfo() {
            return db.collection("model").doc("Bw3HpNujEkSEPHvSTMWD").get().then(function (doc) {
                if (doc.exists) {
                    console.log("Document data:", doc.data());
                } else {
                    console.log("No such document!");
                }
            }).catch(function (error) {
                console.log("Error getting document:", error);
            });
        }

        // -> Denne er samme som oppe, uten at den oppdaterer seg realtime <-
        //         db.collection('model').doc('Bw3HpNujEkSEPHvSTMWD').get().then(
        //             function (collectionSnapshot) {
        //                 console.log(collectionSnapshot.data().pieces);
        //                 model = collectionSnapshot.data();
        //                 pieceObject = collectionSnapshot.data().pieces;
        //                 selectedPiece = collectionSnapshot.data().selectedPiece;
        //                 show()
        //             }
        //         )

        // -> Samme som over, men er for hver array med forEach() <-
        //          db.collection('model').onSnapshot(
        //             function (collectionSnapshot) {
        //                 collectionSnapshot.forEach(
        //                 function (modelItemSnapshot) {
        //                 console.log(modelItemSnapshot.data().pieces);
        //                 model = modelItemSnapshot.data();
        //                 pieceObject = modelItemSnapshot.data().pieces;
        //                 selectedPiece = modelItemSnapshot.data().selectedPiece;
        //             }
        //         )
        //         show()
        //     }
        // )
    </script>
</body>

</html>